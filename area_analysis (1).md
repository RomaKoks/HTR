# Путь развития и компании лидеры

Ни для кого не секрет, что в настоящее время идет бурное развитие в сфере распознавания рукописных текстов. Такие всемирно
известные компании, как Google, Microsoft, AWS, Nintendo, Zi Corporation, Paragon
Software, Hewlett-Packard, ABBYY, Parascript, LLC
и другие, борются за право лидерства в этой области. Разрабатывая данную
программу, мы поставили перед собой цель исследовать алгоритмы, приближающиеся по своим возможностям в плане гибкости
и
параллельной обработки
к механизмам зрения биологических систем, в частности, путем разделения
и оперативного взаимодействия функций зрительного анализатора
и логического (мыслительного) уровня.
Планируется разработать систему адаптации программы
к почерку конкретного человека. Это позволит создавать уменьшенные базы эталонов, что, в свою очередь, ускорит процесс распознавания. 

# Причины развития распознавания рукописного текста

#### Преимущество № 1: Доступ к данным, Возможность поиска и удобство использования

OCR значительно повысил доступность данных. После сканирования и преобразования информации в любой редактируемый формат, такой как MS Word или Adobe PDF, программное обеспечение позволяет хранить или копировать файл в любом месте, где вы хотите, что означает, что файлы затем могут быть найдены в системе вашей компании, и любой человек, имеющий разрешение, может получить к ним доступ. Банковская отрасль и торговые компании получают от этого большую выгоду.

#### Преимущество № 2: Экономия времени и памяти

Хранение в облаке-это правильный путь, если вы хотите иметь доступную для поиска информацию и сэкономить денег. Управление бумажной информацией является неэффективной задачей. Этот процесс является одним из самых трудоемких и дорогих. Но самое худшее в этой ручной работе - большая вероятность человеческой ошибки. Доступ к цифровым данным улучшает рабочие процессы компаний. Используя OCR, компании могут сократить количество ошибок. Это особенно ценится страховыми компаниями из-за большого количества документов, с которыми им приходится работать каждый день.

#### Преимущество № 3: Повышение Удовлетворенности Клиентов

Улучшение качества обслуживания клиентов-это то, к чему стремится каждая компания, и OCR действительно может помочь в этом. Давайте подумаем о зоне поддержки клиентов, где агенты постоянно получают звонки или электронные письма с запросами. Используя технологию программного обеспечения OCR, они могут представить себе все услуги, которые клиент имеет в компании, потому что информация доступна в один клик. Это не только улучшает время, затрачиваемое на каждое дело, но и позволяет службе поддержки клиентов решать любые проблемы, требующие немедленного решения.

#### Преимущество № 4: Повышение безопасности

Цифровая среда требует повышения безопасности, особенно для конфиденциальной информации, управляемой полицейскими департаментами, гражданскими учреждениями или просто для обработки персональных данных. Технология OCR запрограммирована на предотвращение попыток мошенничества путем сравнения предоставленной информации с сохраненными данными с минимумом ошибок, что невозможно сделать вручную.

# Модели

### 1. Attention Mechanisms

Вы можете быть в курсе RNNs или LSTMs, архитектуры нейронных сетей, которые предсказывают выходные данные на каждом временном шаге, предоставляя нам генерацию последовательностей, как нам нужно для языка. Эта порода нейронных сетей предназначена для изучения закономерностей в последовательных данных путем итеративного изменения их текущего состояния на основе текущих входных данных и предыдущих состояний. Но из-за ограничений памяти и таких проблем, как исчезающие градиенты Однако мы обнаружили , что RNNs и LSTMs не способны по-настоящему улавливать влияние слов, находящихся дальше.

Механизм внимания пытается это исправить. Это способ заставить вашу модель изучать дальнодействующие зависимости в определенной последовательности.

![alt text](https://ic.wampi.ru/2021/08/10/sec.png)

### 2. Transformers

Возможно, вы слышали о BERT, GPT2 или о XLNet, которая работает слишком хорошо о задачах языкового моделирования и генерации. Секрет успеха заключается в различных способах применения трансформеров.

Если вы понимаете, как работает внимание, вам не потребуется много усилий, чтобы понять, как работают трансформеры. В сущности, бумага использует многоголовое внимание, которое является ничем иным, как использованием нескольких матриц запросов, ключей и значений и обучением их независимо, объединением их и последующим извлечением матрицы для нашей следующей сети с помощью дополнительного набора весов.

Другим важным дополнением является позиционное вложение, которое кодирует время появления элемента в последовательности. Эти позиционные вложения добавляются к нашим входным вложениям, чтобы сеть лучше изучала временные зависимости.

![alt text](https://ic.wampi.ru/2021/08/10/third.png)

### 3. RAM - Recurrent Attention Model

Эта модель подходит к проблеме внимания, используя обучение с подкреплением, чтобы смоделировать, как работает человеческий глаз. Она определяет вектор проблеска, который извлекает особенности изображения вокруг определенного места.

Несколько таких векторов проблесков, извлекающих объекты из обрезки изображения разного размера вокруг общего центра, затем изменяют размер и преобразуют в постоянное разрешение. Эти векторы проблесков сглаживаются и пропускаются через сеть проблесков, чтобы получить векторное представление, основанное на визуальном внимании.

После этого существует сеть определения местоположения, которая использует RNN, чтобы предсказать, на какую часть изображения наш алгоритм должен обратить внимание в следующий раз. 

![alt text](https://ic.wampi.ru/2021/08/10/fourth.png)

### 4. DRAM - Deep Recurrent Attention Model

Вместо того, чтобы использовать один RNN, DRAM использует два RNN - RNN местоположения для предсказания следующего местоположения проблеска и другой RNN классификации, предназначенный для предсказания меток классов или угадывания того, какой символ мы рассматриваем в тексте. Контекстная сеть используется для сравнения входных данных изображений для более общих состояний RNN.

![alt text](https://ic.wampi.ru/2021/08/10/five.png)

### 5. CRNN - Convolutional Recurrent Neural Networks

CRNN рассматривают нашу задачу OCR не как проблему обучения подкреплению, а как проблему машинного обучения с custom loss. Используемая потеря называется Потеря CTC - Connectionist Temporal Classification. Сверточные слои используются в качестве экстракторов объектов, которые передают эти объекты рекуррентным слоям - двунаправленным LSTM. За ними следует транскрипционный слой, который использует вероятностный подход для декодирования наших выходов LSTM. Каждый кадр, сгенерированный LSTM, декодируется в символ, и эти символы подаются в конечный слой декодера/транскрипции, который выводит окончательную предсказанную последовательность.

![alt text](https://ic.wampi.ru/2021/08/10/YSC.png)

### 6. Spatial Transformer Networks

Эта модель увеличивает входные изображения путем применения аффинных преобразований. Таким образом, обученная модель устойчива к изменениям данных.

Сеть состоит из сети локализации, генератора сетки и сэмплера. Сеть локализации берет входное изображение и дает нам параметры для преобразования, которое мы хотим применить к нему. Генератор сетки использует желаемый выходной шаблон, умножает его на параметры, полученные из сети локализации, и приносит нам местоположение точки, в которой мы хотим применить преобразование, чтобы получить желаемый результат. Билинейное ядро выборки, наконец, используется для генерации наших преобразованных карт объектов.

![alt text](https://graph.power.nstu.ru/wolchin/umm/eskd/glosar/ru/A/affin_transform/002%20(1).gif)

# Результаты метрик

В настоящее время лучшие инструменты распознавания текста, доступные на рынке, не удовлетворительно работают для применения этих API в масштабе для любого случая использования. Google Vision - лучший OCR API доступный прямо сейчас способ способен обеспечить только 80% - ную точность. Точность других продуктов на рынке, таких как Amazon Recognition и Microsoft Cognitive Services - это уныние. Microsoft выполнила работу с точностью 65%, в то время как AWS reсognition выполнила работу только с точностью 21%.

P.S. Под точностью подразумевается метрика **precision**

![alt text](https://ic.wampi.ru/2021/08/10/seven.png)

# Готовые решения и их стоимость

Сколько стоит распознать текст с одной картинки? В Google — это 10 копеек, в Яндексе — 12 копеек, в Microsoft — 5 копеек. Кажется, не так уж дорого.
Но что, если нужно распознать не одну картинку, а, скажем, десятки миллионов? Например, при объемах 50 млн загружаемых изображений в день, нам бы приходилось тратить от 2.5 млн рублей ежедневно. За год получается 1-2 млрд рублей. Это очень дорогое удовольствие для многих компаний

# Применение OCR в Российских компаниях

В **«Ситимобил»**: для осуществления задачи по фотоконтролю такси — распознаем госномер автомобиля на фото. Распознанные данные сравниваются с данными в карточке водителя. Таким образом мы определяем правильная машина пришла на контроль или нет.

В сервисе для объявлений **«Юла»**: с помощью OCR мы находим лекарственные препараты, которые запрещены к продаже на Юле. Для этого распознанный текст сравнивается со справочником лекарственных средств. Кроме того, мы определяем номера телефонов, ссылки на сторонние сайты, ник Инстаграма и т. д.

Для рекламной платформы **myTarget**: мы группируем рекламные баннеры по наличию одинакового текста на изображении. Это позволяет сократить количество ручной модерации, а также использовать текстовые классификаторы для определения рекламы низкого качества.

# Заключение

Использование технологий распознавания текста позволяет легко соответствовать внутренним стандартам документооборота, дает фору автоматизации документооборота, полностью или частично устраняет необходимость в бумажном документообороте. Высокоуровневые услуги оптического распознавания символов могут помочь многим средним и крупным компаниям получить прибыль от использования специально разработанных алгоритмов. Такие отрасли, как банковское дело и финансы, здравоохранение, туризм и логистика, могут извлечь наибольшую выгоду из успешного внедрения OCR. И с каждым годом потребность такой услуги будет только возрастать.
